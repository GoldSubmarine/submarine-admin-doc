(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{361:function(t,a,s){"use strict";s.r(a);var e=s(42),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"excel-导出"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#excel-导出"}},[t._v("#")]),t._v(" Excel 导出")]),t._v(" "),s("p",[t._v("Excel 导出文件，总体来说两个方案：")]),t._v(" "),s("ol",[s("li",[t._v("使用 poi 等操作 excel 的库，写代码来创建 excel")]),t._v(" "),s("li",[t._v("通过模板，填充数据的方式来创建 excel，例如 freemarker,ejs")])]),t._v(" "),s("p",[t._v("如果只是简单的导出数据，不要求样式公式，可以直接使用库创建 excel，但在面对复杂的 excel 时，写模板填充数据的方式更加简单。")]),t._v(" "),s("h2",{attrs:{id:"方案对比"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方案对比"}},[t._v("#")]),t._v(" 方案对比")]),t._v(" "),s("p",[t._v("以下是市面上的一些方案：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("docx4j")]),t._v("：java 处理 word 和 excel 的 sdk，类似 poi，不支持模板处理")]),t._v(" "),s("li",[s("strong",[t._v("exceljs")]),t._v("：浏览器运行 excel api，好处是能保留样式。不支持模板处理")]),t._v(" "),s("li",[s("strong",[t._v("sheetjs")]),t._v("：可以浏览器运行，可以读取 SpreadsheetML，但是保存成 xls 的时候，样式丢失。商业版支持样式，价格预计"),s("code",[t._v("$750")])]),t._v(" "),s("li",[s("strong",[t._v("sail-sail/ejsExcel")]),t._v("：模板渲染。不过是 nodejs 实现，不支持浏览器运行。且模板语言比较难懂。")])]),t._v(" "),s("p",[t._v("还有一些老项目：xelem、JODConverter、easyxls 都不适合")]),t._v(" "),s("h2",{attrs:{id:"最终方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#最终方案"}},[t._v("#")]),t._v(" 最终方案")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("建议")]),t._v(" "),s("p",[t._v("如果没有 app 的情况下，建议把 excel 生成放到前端实现，原因是 js 更加灵活，后台只用提供数据就行")])]),t._v(" "),s("h3",{attrs:{id:"简单数据导出"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简单数据导出"}},[t._v("#")]),t._v(" 简单数据导出")]),t._v(" "),s("p",[t._v("可以直接使用阿里的 "),s("a",{attrs:{href:"https://github.com/alibaba/easyexcel",target:"_blank",rel:"noopener noreferrer"}},[t._v("easyexcel"),s("OutboundLink")],1),t._v(" 生成文件")]),t._v(" "),s("p",[t._v("更推荐的方案是，后台提供数据，前端通过使用 "),s("a",{attrs:{href:"https://github.com/exceljs/exceljs",target:"_blank",rel:"noopener noreferrer"}},[t._v("exceljs"),s("OutboundLink")],1),t._v(" 直接从浏览器导出 excel")]),t._v(" "),s("h3",{attrs:{id:"复杂-excel-导出"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#复杂-excel-导出"}},[t._v("#")]),t._v(" 复杂 excel 导出")]),t._v(" "),s("p",[t._v("excel 分为 03 版和 07 版，即 xls 和 xlsx 的区分，这里我们只讨论 xlsx，xlsx 的本质是一个压缩包，例如有一个 "),s("code",[t._v("example.xlsx")]),t._v(" 文件，修改文件名将其变为 "),s("code",[t._v("example.zip")]),t._v(" ，然后解压该 zip 文件，就可以看到内部的目录了，所以我们的方案是分析 xlsx 内部的文件，制作一个模板，用数据渲染模板，然后重新打成一个 zip 并修改后缀名，给用户下载即可。")]),t._v(" "),s("h4",{attrs:{id:"具体实施方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#具体实施方案"}},[t._v("#")]),t._v(" 具体实施方案")]),t._v(" "),s("p",[t._v("首先打开 excel，制作好一个有样式的模板，然后将其重命名为 zip 格式，解压获取到"),s("code",[t._v("sheet1.xml")]),t._v("，我们采用"),s("code",[t._v("ejs")]),t._v("模板语法将"),s("code",[t._v("sheet1.xml")]),t._v("书写好，然后重新塞回 zip 文件中，前端通过 ajax 获取这个 zip 包的二进制流，通过"),s("code",[t._v("jszip")]),t._v("这个库解压 zip，这样前端 js 就获取到了"),s("code",[t._v("sheet1.xml")]),t._v("这个文件，结合后台返回的数据，用"),s("code",[t._v("ejs")]),t._v("渲染好该模板，将渲染好的模板重新塞回 zip 中，最后前端实现这个 zip 的下载。")]),t._v(" "),s("blockquote",[s("p",[t._v("参考项目："),s("a",{attrs:{href:"https://github.com/GoldSubmarine/export-excel-demo",target:"_blank",rel:"noopener noreferrer"}},[t._v("export-excel-demo"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("以下是一些帮助你分析 xlsx 文件的有用信息，重点关注 "),s("code",[t._v("Shared String")]),t._v(" 和 "),s("code",[t._v("String")]),t._v(" 的区别。")]),t._v(" "),s("h4",{attrs:{id:"目录结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[t._v("#")]),t._v(" 目录结构")]),t._v(" "),s("p",[t._v("解压 excel 文件后，得到下面的文件目录：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("[Content_Types].xml 文件：列出了该工作簿下包含的各个部件信息。")]),t._v(" "),s("ol",[s("li",[t._v("Type： 包含枚举 VSIX 包中的文件类型的子元素")]),t._v(" "),s("li",[t._v("xmlns：(必选)使用此 [Content_Types].xml 文件的架构的位置")]),t._v(" "),s("li",[t._v("Default：ZIP 压缩包每种文件类型的引用， Extension 值为 VSIX 包中的文件扩展名")]),t._v(" "),s("li",[t._v("Override：不同类型文档内容的 XML 部件的引用， PartName 值为链接外部文件的位置")]),t._v(" "),s("li",[t._v("ContentType：说明与文件扩展名相关联的内容类型")])])]),t._v(" "),s("li",[s("p",[t._v("_rels：内含一个名为 .rels 的文件，包含关于该工作簿程序包的各文件关系。")]),t._v(" "),s("ol",[s("li",[t._v("Id：唯一值，可以是任意字符串")]),t._v(" "),s("li",[t._v("Type：包含各文件的关系类型")]),t._v(" "),s("li",[t._v("Target：包含各文件的位置")])])]),t._v(" "),s("li",[s("p",[t._v("docProps：内含一个 app.xml 与一个 core.xml 分别定义工作簿的各元数据。")]),t._v(" "),s("ol",[s("li",[t._v("app.xml 文件下定义了该文档的一些基本属性，包括但不限于“加密情况”、“工作簿名称”、“公司名称”、“应用程序版本”等")]),t._v(" "),s("li",[t._v("core.xml 文件中定义的信息与 app.xml 类似，也是一些基础属性信息，更直观地说的话，就是通过右键“属性/详细信息”查看到信息")])])]),t._v(" "),s("li",[s("p",[t._v("xl：内含多个文件夹及文件，主要为描述该工作簿下各工作表的文件。")]),t._v(" "),s("ol",[s("li",[t._v("sharedStrings.xml：记录表格中输入的各数据信息")]),t._v(" "),s("li",[t._v("styles.xml：Excel 工作表中设置的各样式信息")]),t._v(" "),s("li",[t._v("workbook.xml：定义工作簿中的各个部件信息")]),t._v(" "),s("li",[t._v("printerSettings 文件夹下有一个 printerSettings1.bin 文件，主要是描述应用程序打印时如何打印文档的信息。")]),t._v(" "),s("li",[t._v("theme 文件夹下包含工作簿主题的数据的 XML 文件。比如这里的 theme1.xml 。代码不贴了，没多大意义。")]),t._v(" "),s("li",[t._v("worksheets 文件夹下主要是各个工作表的一些信息，sheet1.xml、sheet2.xml、sheet3.xml 里都是一些描述表的代码，这里就不细说了。同样该文件夹下又有一个 _rels 文件夹，其中有个 sheet1.xml.rels 文件，用于说明该工作表下各文件的关系。")])])])]),t._v(" "),s("blockquote",[s("p",[t._v("参考："),s("a",{attrs:{href:"https://testerhome.com/topics/6050",target:"_blank",rel:"noopener noreferrer"}},[t._v("关于 Excel 文件结构与读写"),s("OutboundLink")],1)])]),t._v(" "),s("h4",{attrs:{id:"row-结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#row-结构"}},[t._v("#")]),t._v(" row 结构")]),t._v(" "),s("p",[t._v("下面分析 sheet1.xml 文件的结构")]),t._v(" "),s("p",[t._v("在 sheetData 标签里，是一个"),s("code",[t._v("row")]),t._v("，结构如下：")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("row")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("r")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("spans")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("1:13"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ht")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("45"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("customHeight")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("c")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("r")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("A1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("s")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("26"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("t")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("v")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("v")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("c")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("c")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("r")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("B1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("s")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("26"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("row")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("其中：")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("row")]),t._v(" 的 "),s("code",[t._v("r")]),t._v(" 表示 Row Index 第几行；"),s("code",[t._v("spans")]),t._v(" 表示哪些列是非空的，是可选项；ht 表示"),s("code",[t._v("Row height")]),t._v("； "),s("code",[t._v("customHeight")]),t._v("表示"),s("code",[t._v("Row height")]),t._v("是否被手动设置过，1 表示是")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("c")]),t._v("表示"),s("code",[t._v("cell")]),t._v("（单元格）；"),s("code",[t._v("r")]),t._v(" 表示 "),s("code",[t._v("Reference")]),t._v(", 单元格的位置；"),s("code",[t._v("s")]),t._v(" 是 "),s("code",[t._v("Style Index")]),t._v("，样式估计存储在"),s("code",[t._v("styles.xml")]),t._v("里；"),s("code",[t._v("t")]),t._v("表示"),s("code",[t._v("Cell Data Type")]),t._v("，表示单元格的数据类型，是一个枚举。可选值有：")]),t._v(" "),s("ul",[s("li",[t._v("b (Boolean)")]),t._v(" "),s("li",[t._v("e (Error)")]),t._v(" "),s("li",[t._v("inlineStr (Inline String)。表示字符不在 "),s("code",[t._v("shared string table")]),t._v("里，这个类型的单元格，填充内容时，可以不用"),s("code",[t._v("v")]),t._v("标签")]),t._v(" "),s("li",[t._v("n (Number)")]),t._v(" "),s("li",[t._v("s (Shared String) 表示内容在"),s("code",[t._v("shared string table")]),t._v("，估计存储在"),s("code",[t._v("sharedStrings.xml")]),t._v("里")]),t._v(" "),s("li",[t._v("str (String) 表示内容是可以是一个公式（公式也可以是普通的字符串）")])])])]),t._v(" "),s("p",[t._v("某些标签的属性不清楚可以参考这个："),s("a",{attrs:{href:"http://webapp.docx4java.org/OnlineDemo/ecma376/SpreadsheetML/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("SpreadsheetML (for .xlsx)"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("分析完 row 的结构，我们可以写它的模板来填充内容。样式我们保持不变，不用关心。")]),t._v(" "),s("p",[t._v("需要注意的是：每个单元格的"),s("code",[t._v("Cell Data Type")]),t._v("都可以指定，因此，模板里原有的内容，可以继续用"),s("code",[t._v("Shared String")]),t._v("（excel 保存默认就是"),s("code",[t._v("Shared String")]),t._v("），我们自己填充数据的时候，可以选择"),s("code",[t._v("str")]),t._v("或者"),s("code",[t._v("inlineStr")]),t._v("。")]),t._v(" "),s("h4",{attrs:{id:"合并单元格"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#合并单元格"}},[t._v("#")]),t._v(" 合并单元格")]),t._v(" "),s("p",[t._v("合并单元格定义如下：")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("mergeCells")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("mergeCell")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("C4:C5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("mergeCell")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("D4:D5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("mergeCells")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("其中："),s("code",[t._v("mergeCells")]),t._v("的"),s("code",[t._v("count")]),t._v("表示"),s("code",[t._v("mergeCell")]),t._v("子标签的数量。"),s("code",[t._v("mergeCell")]),t._v("标签里的"),s("code",[t._v("ref")]),t._v("表示的是 "),s("code",[t._v("cell Reference Range")])]),t._v(" "),s("blockquote",[s("p",[t._v("SpreadsheetML 里 reference 有两种表示方式，一种是"),s("code",[t._v("A1")]),t._v("模式，字母表示列，数字表示行。另一种模式是"),s("code",[t._v("R1C1")]),t._v("模式，行和列都通过数字来表示。另外两种模式都可以指定相对位置，"),s("code",[t._v("A1")]),t._v("模式的相对位置不好懂，"),s("code",[t._v("R1C1")]),t._v("模式的相对位置，只要用"),s("code",[t._v("[]")]),t._v("把数字括起来就可以了。比如"),s("code",[t._v("RC[-3]:RC[-1]")]),t._v("，当 R 不指定数字时，表示整列。参考："),s("a",{attrs:{href:"http://webapp.docx4java.org/OnlineDemo/ecma376/SpreadsheetML/ST_RefMode.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reference Mode"),s("OutboundLink")],1),t._v("、 "),s("a",{attrs:{href:"http://webapp.docx4java.org/OnlineDemo/ecma376/SpreadsheetML/Cell%20References.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cell References"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("合并单元格，需要我们手动指定哪些 cell 需要合并。")]),t._v(" "),s("h4",{attrs:{id:"自动换行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自动换行"}},[t._v("#")]),t._v(" 自动换行")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- styles.xml --\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("xf")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("numFmtId")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("fontId")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("fillId")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("borderId")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("xfId")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("applyAlignment")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("alignment")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("wrapText")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("xf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("设置 "),s("code",[t._v('<alignment wrapText="1" />')]),t._v(" 样式以后，单元格中的文字能自动换行并能撑开高度；但是如果当前单元格为合并单元格，则只能换行，目前没有找到可以撑开高度的方法")]),t._v(" "),s("h4",{attrs:{id:"公式计算"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#公式计算"}},[t._v("#")]),t._v(" 公式计算")]),t._v(" "),s("p",[t._v("当单元格有公式的时候，定义如下")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("c")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("r")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("E16"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("s")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("f")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("SUM(E4:E15)"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("f")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("v")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("6"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("v")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("c")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("这里除了有公式之外，还定义了一个"),s("code",[t._v("v")]),t._v("标签,这个 v 标签不是必须的，如果没有 excel 会重新计算的，因此我们可以删掉"),s("code",[t._v("<v>")]),t._v("。")]),t._v(" "),s("p",[t._v("另外，还需要注意 "),s("code",[t._v("calcChain.xml")]),t._v(" 文件，这个文件跟公式计算有关，它记录了哪些单元格最后被计算了。它不是必须的，直接删除即可（不删掉可能报错），其他文件对该文件的引用记得也得删除哦。")]),t._v(" "),s("blockquote",[s("p",[t._v("参考： "),s("a",{attrs:{href:"http://webapp.docx4java.org/OnlineDemo/ecma376/SpreadsheetML/Calculation%20Chain.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Calculation Chain"),s("OutboundLink")],1)])]),t._v(" "),s("h4",{attrs:{id:"打印设置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#打印设置"}},[t._v("#")]),t._v(" 打印设置")]),t._v(" "),s("p",[t._v("有时候 excel 里有打印设置，对于我们导出来说是没有用的，直接删掉。")]),t._v(" "),s("blockquote",[s("p",[t._v("参考："),s("a",{attrs:{href:"https://docs.aspose.com/display/cellsjava/Remove+Existing+PrinterSettings+of+Worksheets+in+Excel+file",target:"_blank",rel:"noopener noreferrer"}},[t._v("Remove Existing PrinterSettings of Worksheets in Excel file"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);